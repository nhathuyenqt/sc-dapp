{"ast":null,"code":"import axios from 'axios';\nimport { loginConfirmedAction, logout } from '../store/actions/AuthActions';\nexport function signUp(email, password) {\n  //axios call\n  const postData = {\n    email,\n    password,\n    returnSecureToken: true\n  };\n  return axios.post(`https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyD3RPAp3nuETDn9OQimqn_YF6zdzqWITII`, postData);\n}\nexport function login(email, password) {\n  const postData = {\n    email,\n    password,\n    returnSecureToken: true\n  };\n  return axios.post(`https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyD3RPAp3nuETDn9OQimqn_YF6zdzqWITII`, postData);\n}\nexport function formatError(errorResponse) {\n  switch (errorResponse.error.message) {\n    case 'EMAIL_EXISTS':\n      return 'Email already exists';\n\n    case 'EMAIL_NOT_FOUND':\n      return 'Email not found';\n\n    case 'INVALID_PASSWORD':\n      return 'Invalid Password';\n\n    case 'USER_DISABLED':\n      return 'User Disabled';\n\n    default:\n      return '';\n  }\n}\nexport function saveTokenInLocalStorage(tokenDetails) {\n  tokenDetails.expireDate = new Date(new Date().getTime() + tokenDetails.expiresIn * 1000);\n  localStorage.setItem('userDetails', JSON.stringify(tokenDetails));\n}\nexport function runLogoutTimer(dispatch, timer, history) {\n  setTimeout(() => {\n    dispatch(logout(history));\n  }, timer);\n}\nexport function checkAutoLogin(dispatch, history) {\n  const tokenDetailsString = localStorage.getItem('userDetails');\n  let tokenDetails = '';\n\n  if (!tokenDetailsString) {\n    dispatch(logout(history));\n    return;\n  }\n\n  tokenDetails = JSON.parse(tokenDetailsString);\n  let expireDate = new Date(tokenDetails.expireDate);\n  let todaysDate = new Date();\n\n  if (todaysDate > expireDate) {\n    dispatch(logout(history));\n    return;\n  }\n\n  dispatch(loginConfirmedAction(tokenDetails));\n  const timer = expireDate.getTime() - todaysDate.getTime();\n  runLogoutTimer(dispatch, timer, history);\n}","map":{"version":3,"sources":["/Users/kzjouf/Desktop/project/scdapp/src/services/AuthService.js"],"names":["axios","loginConfirmedAction","logout","signUp","email","password","postData","returnSecureToken","post","login","formatError","errorResponse","error","message","saveTokenInLocalStorage","tokenDetails","expireDate","Date","getTime","expiresIn","localStorage","setItem","JSON","stringify","runLogoutTimer","dispatch","timer","history","setTimeout","checkAutoLogin","tokenDetailsString","getItem","parse","todaysDate"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SACIC,oBADJ,EAEIC,MAFJ,QAGO,8BAHP;AAKA,OAAO,SAASC,MAAT,CAAgBC,KAAhB,EAAuBC,QAAvB,EAAiC;AACpC;AAEA,QAAMC,QAAQ,GAAG;AACbF,IAAAA,KADa;AAEbC,IAAAA,QAFa;AAGbE,IAAAA,iBAAiB,EAAE;AAHN,GAAjB;AAMA,SAAOP,KAAK,CAACQ,IAAN,CACF,uGADE,EAEHF,QAFG,CAAP;AAIH;AAED,OAAO,SAASG,KAAT,CAAeL,KAAf,EAAsBC,QAAtB,EAAgC;AACnC,QAAMC,QAAQ,GAAG;AACbF,IAAAA,KADa;AAEbC,IAAAA,QAFa;AAGbE,IAAAA,iBAAiB,EAAE;AAHN,GAAjB;AAMA,SAAOP,KAAK,CAACQ,IAAN,CACF,mHADE,EAEHF,QAFG,CAAP;AAIH;AAED,OAAO,SAASI,WAAT,CAAqBC,aAArB,EAAoC;AACvC,UAAQA,aAAa,CAACC,KAAd,CAAoBC,OAA5B;AACI,SAAK,cAAL;AACI,aAAO,sBAAP;;AAEJ,SAAK,iBAAL;AACI,aAAO,iBAAP;;AACJ,SAAK,kBAAL;AACI,aAAO,kBAAP;;AACJ,SAAK,eAAL;AACI,aAAO,eAAP;;AAEJ;AACI,aAAO,EAAP;AAZR;AAcH;AAED,OAAO,SAASC,uBAAT,CAAiCC,YAAjC,EAA+C;AAClDA,EAAAA,YAAY,CAACC,UAAb,GAA0B,IAAIC,IAAJ,CACtB,IAAIA,IAAJ,GAAWC,OAAX,KAAuBH,YAAY,CAACI,SAAb,GAAyB,IAD1B,CAA1B;AAGAC,EAAAA,YAAY,CAACC,OAAb,CAAqB,aAArB,EAAoCC,IAAI,CAACC,SAAL,CAAeR,YAAf,CAApC;AACH;AAED,OAAO,SAASS,cAAT,CAAwBC,QAAxB,EAAkCC,KAAlC,EAAyCC,OAAzC,EAAkD;AACrDC,EAAAA,UAAU,CAAC,MAAM;AACbH,IAAAA,QAAQ,CAACvB,MAAM,CAACyB,OAAD,CAAP,CAAR;AACH,GAFS,EAEPD,KAFO,CAAV;AAGH;AAED,OAAO,SAASG,cAAT,CAAwBJ,QAAxB,EAAkCE,OAAlC,EAA2C;AAC9C,QAAMG,kBAAkB,GAAGV,YAAY,CAACW,OAAb,CAAqB,aAArB,CAA3B;AACA,MAAIhB,YAAY,GAAG,EAAnB;;AACA,MAAI,CAACe,kBAAL,EAAyB;AACrBL,IAAAA,QAAQ,CAACvB,MAAM,CAACyB,OAAD,CAAP,CAAR;AACA;AACH;;AAEDZ,EAAAA,YAAY,GAAGO,IAAI,CAACU,KAAL,CAAWF,kBAAX,CAAf;AACA,MAAId,UAAU,GAAG,IAAIC,IAAJ,CAASF,YAAY,CAACC,UAAtB,CAAjB;AACA,MAAIiB,UAAU,GAAG,IAAIhB,IAAJ,EAAjB;;AAEA,MAAIgB,UAAU,GAAGjB,UAAjB,EAA6B;AACzBS,IAAAA,QAAQ,CAACvB,MAAM,CAACyB,OAAD,CAAP,CAAR;AACA;AACH;;AACDF,EAAAA,QAAQ,CAACxB,oBAAoB,CAACc,YAAD,CAArB,CAAR;AAEA,QAAMW,KAAK,GAAGV,UAAU,CAACE,OAAX,KAAuBe,UAAU,CAACf,OAAX,EAArC;AACAM,EAAAA,cAAc,CAACC,QAAD,EAAWC,KAAX,EAAkBC,OAAlB,CAAd;AACH","sourcesContent":["import axios from 'axios';\nimport {\n    loginConfirmedAction,\n    logout,\n} from '../store/actions/AuthActions';\n\nexport function signUp(email, password) {\n    //axios call\n\n    const postData = {\n        email,\n        password,\n        returnSecureToken: true,\n    };\n\n    return axios.post(\n        `https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyD3RPAp3nuETDn9OQimqn_YF6zdzqWITII`,\n        postData,\n    );\n}\n\nexport function login(email, password) {\n    const postData = {\n        email,\n        password,\n        returnSecureToken: true,\n    };\n\n    return axios.post(\n        `https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyD3RPAp3nuETDn9OQimqn_YF6zdzqWITII`,\n        postData,\n    );\n}\n\nexport function formatError(errorResponse) {\n    switch (errorResponse.error.message) {\n        case 'EMAIL_EXISTS':\n            return 'Email already exists';\n\n        case 'EMAIL_NOT_FOUND':\n            return 'Email not found';\n        case 'INVALID_PASSWORD':\n            return 'Invalid Password';\n        case 'USER_DISABLED':\n            return 'User Disabled';\n\n        default:\n            return '';\n    }\n}\n\nexport function saveTokenInLocalStorage(tokenDetails) {\n    tokenDetails.expireDate = new Date(\n        new Date().getTime() + tokenDetails.expiresIn * 1000,\n    );\n    localStorage.setItem('userDetails', JSON.stringify(tokenDetails));\n}\n\nexport function runLogoutTimer(dispatch, timer, history) {\n    setTimeout(() => {\n        dispatch(logout(history));\n    }, timer);\n}\n\nexport function checkAutoLogin(dispatch, history) {\n    const tokenDetailsString = localStorage.getItem('userDetails');\n    let tokenDetails = '';\n    if (!tokenDetailsString) {\n        dispatch(logout(history));\n        return;\n    }\n\n    tokenDetails = JSON.parse(tokenDetailsString);\n    let expireDate = new Date(tokenDetails.expireDate);\n    let todaysDate = new Date();\n\n    if (todaysDate > expireDate) {\n        dispatch(logout(history));\n        return;\n    }\n    dispatch(loginConfirmedAction(tokenDetails));\n\n    const timer = expireDate.getTime() - todaysDate.getTime();\n    runLogoutTimer(dispatch, timer, history);\n}\n"]},"metadata":{},"sourceType":"module"}